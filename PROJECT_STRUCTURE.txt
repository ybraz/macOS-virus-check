VirusTotal Scanner for macOS - Project Structure
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

macos-virus-check/
â”‚
â”œâ”€â”€ ğŸ“„ Core Documentation
â”‚   â”œâ”€â”€ README.md                 # Main documentation
â”‚   â”œâ”€â”€ QUICKSTART.md            # Quick start guide
â”‚   â”œâ”€â”€ ARCHITECTURE.md          # Architecture details
â”‚   â”œâ”€â”€ CONTRIBUTING.md          # Contribution guidelines
â”‚   â”œâ”€â”€ CHANGELOG.md             # Version history
â”‚   â””â”€â”€ LICENSE                  # MIT License
â”‚
â”œâ”€â”€ ğŸ Source Code (src/)
â”‚   â”œâ”€â”€ __init__.py              # Package initialization
â”‚   â”œâ”€â”€ vt_scanner.py            # VirusTotal API client
â”‚   â”œâ”€â”€ cli.py                   # CLI interface (Click + Rich)
â”‚   â”œâ”€â”€ config.py                # Configuration & cache management
â”‚   â””â”€â”€ utils.py                 # Utility functions
â”‚
â”œâ”€â”€ ğŸ”§ Automator Integration (automator/)
â”‚   â”œâ”€â”€ __init__.py              # Package initialization
â”‚   â”œâ”€â”€ vt_quick_action.py       # Quick Action script
â”‚   â””â”€â”€ create_quick_action.sh   # Quick Action installer
â”‚
â”œâ”€â”€ ğŸ“š Examples (examples/)
â”‚   â””â”€â”€ example_usage.py         # Python API usage examples
â”‚
â”œâ”€â”€ ğŸš€ Installation & Setup
â”‚   â”œâ”€â”€ install.sh               # Main installation script
â”‚   â”œâ”€â”€ test_installation.sh     # Installation verification
â”‚   â”œâ”€â”€ requirements.txt         # Python dependencies
â”‚   â””â”€â”€ .env.example            # Environment variable template
â”‚
â””â”€â”€ ğŸ”’ Configuration (generated at runtime)
    â””â”€â”€ ~/.config/vt-scanner/    # User configuration directory
        â”œâ”€â”€ config.json          # API key & settings
        â””â”€â”€ cache/               # Cached scan results

Key Features by File:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

vt_scanner.py:
  â€¢ VirusTotal API v3 client
  â€¢ File hash calculation (SHA-256)
  â€¢ Smart hash-first checking
  â€¢ File upload & analysis
  â€¢ Result parsing & formatting

cli.py:
  â€¢ Rich CLI interface
  â€¢ Commands: scan, hash, config
  â€¢ Progress indicators
  â€¢ Color-coded output
  â€¢ JSON export option
  â€¢ Batch scanning support

config.py:
  â€¢ Secure API key storage
  â€¢ Environment variable support
  â€¢ Local result caching (7-day TTL)
  â€¢ Configuration management
  â€¢ Cache cleanup utilities

utils.py:
  â€¢ File size formatting
  â€¢ Timestamp conversion
  â€¢ macOS notifications
  â€¢ Path validation
  â€¢ File type detection
  â€¢ Threat level indicators

vt_quick_action.py:
  â€¢ Finder integration
  â€¢ Context menu handler
  â€¢ Notification sender
  â€¢ Cache integration

User Workflows:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CLI Workflow:
  1. User runs: vt-check scan file.dmg
  2. CLI calculates file hash
  3. Checks local cache
  4. Queries VirusTotal (hash first)
  5. Uploads if needed
  6. Displays formatted results

Quick Action Workflow:
  1. User right-clicks file in Finder
  2. Selects "VirusTotal Scan"
  3. Automator triggers vt_quick_action.py
  4. Script scans file
  5. macOS notification shows results
  6. Click notification â†’ view full report

Installation Workflow:
  1. User runs: ./install.sh
  2. Checks Python & dependencies
  3. Creates virtual environment (optional)
  4. Installs Python packages
  5. Creates vt-check command
  6. Configures API key
  7. Installs Quick Action (optional)

Commands Overview:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

vt-check scan [FILES]
  Scan one or more files for malware
  Options:
    -r, --recursive       Scan directories recursively
    -f, --force-upload    Force upload even if hash exists
    -n, --notify          Send macOS notification
    -o, --open-report     Open report in browser
    --json                Output as JSON
    --no-cache            Disable cache

vt-check hash HASH_VALUE
  Check a file hash without uploading
  Options:
    -o, --open-report     Open report in browser

vt-check config
  Manage configuration and settings
  Options:
    --api-key KEY         Set VirusTotal API key
    --show                Show current configuration
    --clear-cache         Clear cached results

Dependencies:
â•â•â•â•â•â•â•â•â•â•â•â•â•

Runtime:
  â€¢ Python 3.8+
  â€¢ requests (HTTP client)
  â€¢ click (CLI framework)
  â€¢ rich (terminal formatting)
  â€¢ pync (macOS notifications)
  â€¢ python-magic (file type detection)

Development:
  â€¢ pytest (testing)
  â€¢ black (code formatting)
  â€¢ flake8 (linting)
  â€¢ mypy (type checking)

Security Features:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ API key stored with 600 permissions (owner only)
âœ“ Environment variable support for CI/CD
âœ“ Hash-first approach minimizes uploads
âœ“ Local caching reduces API calls
âœ“ No telemetry or tracking
âœ“ Privacy-focused design

Performance:
â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ Hash-based cache (7-day TTL)
âœ“ Avoids redundant API calls
âœ“ Parallel file processing ready
âœ“ Efficient file hashing (chunked reading)
âœ“ Minimal memory footprint

Support:
â•â•â•â•â•â•â•â•

Issues: https://github.com/yourusername/macos-virus-check/issues
Docs: README.md, QUICKSTART.md, ARCHITECTURE.md
API: https://developers.virustotal.com/reference/overview

Version: 1.0.0
License: MIT
